name: Build Wine for FreeBSD

on: 
  workflow_dispatch:
    inputs:
      winetype:
        description: "The type of Wine to build"
        required: true
        default: "staging"
        type: choice
        options:
        - staging
        - proton
        - devel
        - patched
      wineversion:
        description: "The version of Wine to build"
        required: true
        default: "7.4"
        type: string

jobs:
  freebsd64:
    runs-on: macos-12
    steps:
    - uses: actions/checkout@v2
    - name: Build Wine for FreeBSD 64-bit
      uses: vmactions/freebsd-vm@v0
      with:
        run: |
          pkg install -y git nim
          git clone https://git.FreeBSD.org/ports.git /usr/ports
          nim --hints:off build.nims ${{ inputs.wineversion }} ${{ inputs.winetype }}
          
    - name: Release
      uses: softprops/action-gh-release@v1
      with:
        name: 13.1-amd64
        tag_name: 13.1-amd64
        files: '*.pkg'
